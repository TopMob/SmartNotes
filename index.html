<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>SmartNotes</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/stylessidebar.css">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
</head>
<body>

    <div class="bg-wrapper"></div>

    <div id="login-screen" class="login-container active">
        <div class="login-card">
            <h1>SmartNotes</h1>
            <p>–í–∞—à–∏ –º—ã—Å–ª–∏. –í –ø–æ—Ä—è–¥–∫–µ.</p>
            <button class="btn-google" onclick="Auth.login()">
                <img src="https://www.gstatic.com/images/branding/product/1x/googleg_48dp.png" alt="Google">
                –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
            </button>
        </div>
    </div>

    <div id="app" class="app-layout">
        
        <aside id="sidebar" class="sidebar-glass">
            <div class="sidebar-header">
                <span class="brand-text-fixed">SmartNotes</span>
                <button class="btn-icon mobile-only" onclick="UI.toggleSidebar(false)">
                    <i class="material-icons-round">close</i>
                </button>
            </div>

            <nav class="sidebar-nav scrollable">
                <div class="nav-group">
                    <button class="nav-item active" onclick="switchView('notes')" data-view="notes">
                        <i class="material-icons-round">description</i>
                        <span>–í—Å–µ –∑–∞–ø–∏—Å–∏</span>
                    </button>
                    <button class="nav-item" onclick="switchView('favorites')" data-view="favorites">
                        <i class="material-icons-round">star</i>
                        <span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                    </button>
                    <button class="nav-item" onclick="switchView('archive')" data-view="archive">
                        <i class="material-icons-round">archive</i>
                        <span>–ê—Ä—Ö–∏–≤</span>
                    </button>
                </div>

                <div class="nav-divider"></div>

                <div class="folders-header">
                    <span>–ü–ê–ü–ö–ò</span>
                    <button class="btn-icon-small" onclick="createNewFolder()">
                        <i class="material-icons-round">add</i>
                    </button>
                </div>
                <div id="folder-list-root" class="folder-list"></div>
            </nav>

            <div class="sidebar-footer">
                <button class="footer-link" onclick="UI.openModal('about-modal')">
                    <i class="material-icons-round">info</i> –û –Ω–∞—Å
                </button>
                <button class="footer-link" onclick="UI.openModal('rate-modal')">
                    <i class="material-icons-round">thumb_up</i> –û—Ü–µ–Ω–∏—Ç—å
                </button>
                <button class="footer-link" onclick="UI.openSettings()">
                    <i class="material-icons-round">settings</i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
                </button>
            </div>
        </aside>

        <main class="main-content">
            <header class="top-bar">
                <div class="header-left">
                    <button id="menu-toggle" class="btn-icon" onclick="UI.toggleSidebar()">
                        <i class="material-icons-round">menu</i>
                    </button>
                    <h2 id="current-view-title" class="mobile-only-title">–ó–∞–º–µ—Ç–∫–∏</h2>
                </div>

                <div class="search-container">
                    <i class="material-icons-round search-icon">search</i>
                    <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ (—Ç–µ–∫—Å—Ç, #—Ç–µ–≥–∏)..." oninput="filterAndRender(this.value)">
                </div>

                <div class="header-right">
                    <div class="user-avatar-wrapper">
                        <img id="user-photo" src="" alt="User" class="header-avatar" onclick="UI.toggleUserMenu()">
                        <div id="user-dropdown" class="dropdown-menu">
                            <div class="dropdown-header">
                                <span id="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
                            </div>
                            <button class="dropdown-item" onclick="UI.showConfirm('–°–º–µ–Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–∞', '–°–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?', () => Auth.switchAccount())">
                                <i class="material-icons-round">switch_account</i> –°–º–µ–Ω–∏—Ç—å
                            </button>
                            <button class="dropdown-item danger" onclick="UI.showConfirm('–í—ã—Ö–æ–¥', '–í—ã–π—Ç–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã?', () => Auth.logout())">
                                <i class="material-icons-round">logout</i> –í—ã–π—Ç–∏
                            </button>
                        </div>
                    </div>
                </div>
            </header>

            <div id="notes-content-area" class="content-scrollable scrollable">
                <div id="app-loader" class="loader-container hidden">
                    <div class="spinner"></div>
                </div>

                <div id="empty-state" class="empty-placeholder hidden">
                    <i class="material-icons-round">note_add</i>
                    <p>–ó–¥–µ—Å—å –ø–æ–∫–∞ –ø—É—Å—Ç–æ</p>
                    <span>–°–æ–∑–¥–∞–π—Ç–µ –ø–µ—Ä–≤—É—é –∑–∞–º–µ—Ç–∫—É</span>
                </div>

                <div id="notes-container" class="notes-grid"></div>
            </div>

            <button class="btn-fab" onclick="Editor.open()">
                <i class="material-icons-round">add</i>
            </button>
        </main>
    </div>

    <div id="note-editor" class="editor-overlay">
        <div class="editor-container">
            <div class="editor-header-bar">
                <button class="btn-icon close-editor-btn" onclick="Editor.close()">
                    <i class="material-icons-round">close</i>
                </button>
                
                <div class="editor-tools">
                    <button class="btn-icon" onclick="Editor.undo()" title="–ù–∞–∑–∞–¥ (Ctrl+Z)">
                        <i class="material-icons-round">undo</i>
                    </button>
                    <button class="btn-icon" onclick="Editor.redo()" title="–í–ø–µ—Ä–µ–¥ (Ctrl+Y)">
                        <i class="material-icons-round">redo</i>
                    </button>
                    <div class="divider-vertical"></div>
                    <button class="btn-icon" id="important-btn" onclick="Editor.toggleImportant()" title="–í–∞–∂–Ω–æ–µ">
                        <i class="material-icons-round">priority_high</i>
                    </button>
                    <button class="btn-icon" id="pin-btn" onclick="Editor.togglePin()" title="–ó–∞–∫—Ä–µ–ø–∏—Ç—å">
                        <i class="material-icons-round">push_pin</i>
                    </button>
                    <button class="btn-icon" id="archive-btn" onclick="Editor.toggleArchive()" title="–ê—Ä—Ö–∏–≤">
                        <i class="material-icons-round">archive</i>
                    </button>
                    <button class="btn-icon delete-icon" onclick="Editor.deleteCurrent()" title="–£–¥–∞–ª–∏—Ç—å">
                        <i class="material-icons-round">delete</i>
                    </button>
                </div>
                
                <button class="btn-primary mobile-save-btn" onclick="Editor.close()">
                    <i class="material-icons-round">check</i>
                </button>
            </div>

            <div class="editor-scroll-area">
                <input type="text" id="note-title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫" autocomplete="off">
                <textarea id="note-content" placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å..." class="scrollable"></textarea>
            </div>

            <div class="editor-bottom-panel">
                <div class="tags-section">
                    <div id="note-tags-container" class="tags-list-editor"></div>
                    <input type="text" id="note-tags-input" placeholder="–î–æ–±–∞–≤–∏—Ç—å #—Ç–µ–≥ (Enter)">
                </div>
                <div class="editor-status">
                    <span id="last-edited">–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ</span>
                </div>
            </div>
        </div>
    </div>

    <div id="settings-modal" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header">
                <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
                <button class="btn-icon" onclick="UI.closeSettings()">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body scrollable">
                <div class="settings-section">
                    <h3>–Ø–∑—ã–∫</h3>
                    <div class="toggle-switch">
                        <div class="toggle-opt active">RU</div>
                        <div class="toggle-opt">EN</div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                    <p class="subtext">–¢–µ–º—ã</p>
                    <div id="theme-picker-root" class="theme-grid"></div>
                    
                    <p class="subtext" style="margin-top:20px;">–°–≤–æ–∏ —Ü–≤–µ—Ç–∞</p>
                    <div class="color-pickers-grid">
                        <div class="color-picker-item">
                            <span>–¢–µ–∫—Å—Ç</span>
                            <input type="color" id="cp-text" class="input-color-custom">
                        </div>
                        <div class="color-picker-item">
                            <span>–ê–∫—Ü–µ–Ω—Ç</span>
                            <input type="color" id="cp-primary" class="input-color-custom">
                        </div>
                        <div class="color-picker-item">
                            <span>–§–æ–Ω</span>
                            <input type="color" id="cp-bg" class="input-color-custom">
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary" onclick="UI.closeSettings()">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn-primary" onclick="UI.saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="about-modal" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header">
                <h2>–ö–æ–º–∞–Ω–¥–∞</h2>
                <button class="btn-icon" onclick="UI.closeModal('about-modal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <ul class="team-list" style="list-style: none; padding: 0;">
                    <li style="margin-bottom: 12px; font-weight:600;">üë®‚Äçüíª –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤ –ê—Ä—Å–µ–Ω–∏–π</li>
                    <li style="margin-bottom: 12px; font-weight:600;">üë®‚Äçüíª –ö–æ–ø–∞–µ–≤ –ò–≤–∞–Ω</li>
                    <li style="margin-bottom: 12px; font-weight:600;">üë®‚Äçüíª –ú–∞–ª—ã—à–µ–≤ –ï–≥–æ—Ä</li>
                    <li style="margin-bottom: 12px; font-weight:600;">üë®‚Äçüíª –ú–∏–Ω—è–µ–≤ –ò–≤–∞–Ω</li>
                </ul>
                <a href="https://t.me/SmartNotesInfo_bot" target="_blank" class="btn-primary telegram-btn">
                    <i class="material-icons-round">smart_toy</i> @SmartNotesInfo_bot
                </a>
            </div>
        </div>
    </div>

    <div id="rate-modal" class="modal-overlay">
        <div class="modal-card">
            <div class="modal-header">
                <h2>–û—Ü–µ–Ω–∏—Ç—å</h2>
                <button class="btn-icon" onclick="UI.closeModal('rate-modal')">
                    <i class="material-icons-round">close</i>
                </button>
            </div>
            <div class="modal-body">
                <div class="star-rating" style="margin-bottom: 20px;">
                    <i class="material-icons-round star" data-val="1">star_border</i>
                    <i class="material-icons-round star" data-val="2">star_border</i>
                    <i class="material-icons-round star" data-val="3">star_border</i>
                    <i class="material-icons-round star" data-val="4">star_border</i>
                    <i class="material-icons-round star" data-val="5">star_border</i>
                </div>
                <textarea id="feedback-text" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –æ—Ç–∑—ã–≤..." rows="4" style="width:100%; background:rgba(255,255,255,0.05); border:1px solid var(--border); color:var(--text); padding:10px; border-radius:10px; resize:none;"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="UI.submitFeedback()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <div id="confirm-modal" class="modal-overlay confirm-layer">
        <div class="confirm-box">
            <h3 id="confirm-title" style="margin-bottom:10px;">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ</h3>
            <p id="confirm-msg" style="margin-bottom:20px; color:var(--text-dim);">–í—ã —É–≤–µ—Ä–µ–Ω—ã?</p>
            <div style="display:flex; justify-content:center; gap:10px;">
                <button class="btn-secondary" id="confirm-cancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn-danger" id="confirm-ok">–î–∞</button>
            </div>
        </div>
    </div>

    <div id="toast-container"></div>

    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/ab.js"></script>
    <script src="js/editor.js"></script>
</body>
</html>
